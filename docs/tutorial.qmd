---
title: "Tutorial"
---

This tutorial demonstrates how to use the `weighted_aalen_johansen` function to perform weighted event prediction.

## Basic Usage

First, let's import the necessary libraries:

```python
import polars as pl
from weightedstate.survival import weighted_aalen_johansen
```

Now, let's create some sample data:

```python
times = pl.Series([1, 2, 3, 4, 5])
reals = pl.Series([1, 0, 1, 2, 0])
weights = pl.Series([1.0, 1.0, 1.0, 1.0, 1.0])
```

We can now call the `weighted_aalen_johansen` function with this data:

```python
result = weighted_aalen_johansen(times, reals, weights)
print(result)
```

## Kaplan-Meier Estimation

To perform a Kaplan-Meier estimation, we simply need to ensure that there are no competing events (i.e., `reals` does not contain the value 2):

```python
reals_km = pl.Series([1, 0, 1, 1, 0])
result_km = weighted_aalen_johansen(times, reals_km, weights)
print(result_km)
```

## Weighted Estimation

The function also supports weighted estimations. Let's create a new set of weights and see how it affects the result:

```python
weights_weighted = pl.Series([0.5, 1.5, 0.8, 1.2, 0.9])
result_weighted = weighted_aalen_johansen(times, reals, weights_weighted)
print(result_weighted)
```
